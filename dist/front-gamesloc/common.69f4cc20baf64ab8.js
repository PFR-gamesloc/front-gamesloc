"use strict";(self.webpackChunkfront_gamesloc=self.webpackChunkfront_gamesloc||[]).push([[592],{5150:(M,d,a)=>{a.d(d,{H:()=>O});var _=a(3620),u=a(3997),t=a(5879),f=a(623),p=a(6223),m=a(6814),C=a(4630),g=a(3680),h=a(2032),y=a(7077);const Z=["autoCityName"];function N(n,l){if(1&n&&(t.TgZ(0,"mat-option",8),t._uU(1),t.qZA()),2&n){const s=l.$implicit;t.Q6J("value",s),t.xp6(1),t.hij(" ",s," ")}}function v(n,l){1&n&&(t.ynx(0),t._UZ(1,"app-error-message"),t.BQk())}function P(n,l){if(1&n&&(t.TgZ(0,"mat-option",8),t._uU(1),t.qZA()),2&n){const s=l.$implicit;t.Q6J("value",s),t.xp6(1),t.hij(" ",s," ")}}function E(n,l){1&n&&(t.ynx(0),t._UZ(1,"app-error-message"),t.BQk())}let O=(()=>{var n;class l{constructor(o,e){this.customerService=o,this.rootFormGroup=e,this.options=[],this.filteredPostalCodes=[],this.filteredCityNames=[],this.postalCodes=[],this.cityNames=[]}ngOnInit(){this.formZipCode=this.rootFormGroup.control,this.formZipCode.get("postalCode")?.valueChanges.pipe((0,_.b)(300),(0,u.x)()).subscribe({next:o=>{o.length>=3?(this.customerService.getCities(o).subscribe({next:e=>{this.handlePostalCode(e),this.handleCityName(e)}}),this.filterCityNames()):this.filteredCityNames=[]}})}_filter(o){const e=o.toLowerCase();return this.postalCodes.filter(i=>i.toLowerCase().startsWith(e))}_filterCityNamesByPostalCode(o,e){const i=o.toLowerCase();return this.options.filter(c=>c.postalCode.toLowerCase().startsWith(i)).filter(c=>c.cityName.toLowerCase().startsWith(e.toLowerCase())).map(c=>c.cityName)}handlePostalCode(o){const e=new Set(o.map(i=>i.postalCode));this.postalCodes=Array.from(e)}handleCityName(o){const e=new Set;for(let i of o)e.add(i.cityName);this.cityNames=Array.from(e),this.options=o}filterCityNames(){this.filteredCityNames=this._filterCityNamesByPostalCode(this.formZipCode.value?this.formZipCode.value.postalCode:"",this.formZipCode.value?this.formZipCode.value.cityName:"")}onCitySelected(o){const e=o.option.value,i=this.options.find(r=>r.cityName===e);i&&void 0!==this.autoCityName&&this.formZipCode.get("postalCode")?.setValue(i.postalCode)}get postalErrors(){return this.formZipCode.get("postalCode")?.errors}get cityErrors(){return this.formZipCode.get("cityName")?.errors}checkPostalValidity(){return this.formZipCode.get("postalCode")?.invalid&&(this.formZipCode.get("postalCode")?.touched||this.formZipCode.get("postalCode")?.dirty)}checkCityValidity(){return this.formZipCode.get("cityName")?.invalid&&(this.formZipCode.get("cityName")?.touched||this.formZipCode.get("cityName")?.dirty)}}return(n=l).\u0275fac=function(o){return new(o||n)(t.Y36(f.v),t.Y36(p.sg))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-select"]],viewQuery:function(o,e){if(1&o&&t.Gf(Z,5),2&o){let i;t.iGM(i=t.CRH())&&(e.autoCityName=i.first)}},decls:19,vars:7,consts:[[3,"formGroup"],[1,"container-select"],["type","text","placeholder","S\xe9lectionner votre code postal","aria-label","Code Postal","matInput","","formControlName","postalCode",3,"matAutocomplete","input"],["autoZipCode","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["type","text","placeholder","S\xe9lectionner votre ville","aria-label","Ville","matInput","","formControlName","cityName",3,"matAutocomplete","click"],["autoCityName","matAutocomplete"],[3,"value"]],template:function(o,e){if(1&o&&(t.ynx(0,0),t.TgZ(1,"div",1)(2,"label")(3,"div"),t._uU(4," Code Postal "),t.qZA()(),t.TgZ(5,"input",2),t.NdJ("input",function(){let r;return e.filteredPostalCodes=e._filter(null==(r=e.formZipCode.get("postalCode"))?null:r.value)}),t.qZA(),t.TgZ(6,"mat-autocomplete",null,3),t.YNc(8,N,2,2,"mat-option",4),t.qZA(),t.YNc(9,v,2,0,"ng-container",5),t.qZA(),t.TgZ(10,"div",1)(11,"label")(12,"div"),t._uU(13," Ville "),t.qZA()(),t.TgZ(14,"input",6),t.NdJ("click",function(){return e.filterCityNames()}),t.qZA(),t.TgZ(15,"mat-autocomplete",null,7),t.YNc(17,P,2,2,"mat-option",4),t.qZA(),t.YNc(18,E,2,0,"ng-container",5),t.qZA(),t.BQk()),2&o){const i=t.MAs(7),r=t.MAs(16);t.Q6J("formGroup",e.formZipCode),t.xp6(5),t.Q6J("matAutocomplete",i),t.xp6(3),t.Q6J("ngForOf",e.postalCodes),t.xp6(1),t.Q6J("ngIf",e.postalErrors),t.xp6(5),t.Q6J("matAutocomplete",r),t.xp6(3),t.Q6J("ngForOf",e.filteredCityNames),t.xp6(1),t.Q6J("ngIf",e.cityErrors)}},dependencies:[m.sg,m.O5,p.Fj,p.JJ,p.JL,p.sg,p.u,C.XC,g.ey,C.ZL,h.Nt,y.H],styles:[".container-select[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;padding:5px}.container-select[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:flex;position:relative}.container-select[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]{background-color:#fff;color:#19647e;position:relative;top:8px;left:15px;padding:0 5px}.container-select[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:.5px solid #19647e;border-radius:10px;padding:10px 5px}@media (min-width: 1024px){.container[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:15px 10px}}"]}),l})()}}]);